import{E as C,g as k,B as w,c as l,a as x,o as c,b as o,d as e,t as v,j as u,G as y,F as g,C as h,h as S,v as I,p as A,l as B,D}from"./vendor.33337ddb.js";import{_ as j,e as E,c as b,P as r,l as m,r as P,A as d}from"./index.9d3f27db.js";import{a as f}from"./AttendeesService.05c574f8.js";const M={setup(){const i=C(),n=k({eventId:i.params.id,body:""});return w(async()=>{try{await E.getEventById(i.params.id),await b.getCommentsByEventId(i.params.id),await f.getAttendees(i.params.id)}catch(a){r.toast(a.message,"error"),m.log(a)}}),{editable:n,account:l(()=>d.account),activeEvent:l(()=>d.activeEvent),comments:l(()=>d.comments),myEvents:l(()=>d.myEvents),attendees:l(()=>d.attendees),isAttending:l(()=>!!d.attendees.find(a=>a.accountId==d.account.id)),async createComment(){try{await b.createComment(n.value),n.value.body="",r.toast("Comment successful!")}catch(a){r.toast(a.message,"error"),m.log(a)}},async cancelEvent(){try{await r.confirm()&&(await E.cancelEvent(i.params.id),P.push({name:"Home"}))}catch(a){r.toast(a.message,"error"),m.log(a)}},async attendEvent(a,t){try{await f.attendEvent(a,t),r.toast("You've successfully marked yourself as attending!")}catch(_){r.toast(_.message,"error"),m.log(_)}}}}},V=i=>(A("data-v-ae3c20b6"),i=i(),B(),i),F={class:"container-fluid"},N={class:"row justify-content-center"},T={class:"col-md-11"},G={class:"card mt-3"},H=["src"],L={class:"card-body"},O={class:"d-flex justify-content-between"},R={class:"card-title"},U={class:"card-text"},Y={class:"card-text"},q={class:"d-flex justify-content-end"},z={key:0,class:"text-danger"},J={key:1,class:"text-danger"},K={key:3},Q={key:4,class:"btn btn-info mx-2"},W=V(()=>e("h5",null,"Other Attendees:",-1)),X=["src","title"],Z={class:"col-md-9 bg-white mt-3 px-3"},$={key:0,class:"row mx-1 my-3"};function tt(i,n,a,t,_,et){const p=x("CommentCard");return c(),o("div",F,[e("div",N,[e("div",T,[e("div",G,[e("img",{src:t.activeEvent.coverImg,class:"card-img-top rounded imgBanner",alt:"..."},null,8,H),e("div",L,[e("div",O,[e("h3",R,v(t.activeEvent.name)+" - "+v(t.activeEvent.location),1),e("h4",null,v(t.activeEvent.capacity)+" seats remaining.",1)]),e("h6",U,v(new Date(t.activeEvent.startDate).toDateString())+" - "+v(new Date(t.activeEvent.startDate).toTimeString()),1),e("p",Y,v(t.activeEvent.description),1),e("div",q,[t.activeEvent.isCanceled?(c(),o("h3",z,"Sorry, this event has been cancelled.")):t.activeEvent.capacity==0?(c(),o("h3",J,"Sorry, this event has reached it's capacity.")):t.account.id&&!t.activeEvent.isCanceled&&!t.isAttending?(c(),o("button",{key:2,class:"btn btn-success",onClick:n[0]||(n[0]=u(s=>t.attendEvent(t.account.id,t.activeEvent.id),["prevent"]))},"Mark as attending")):(c(),o("button",K,"you are attending")),t.activeEvent.creatorId===t.account.id&&!t.activeEvent.isCanceled?(c(),o("button",Q,"Edit Event")):y("",!0),t.activeEvent.creatorId===t.account.id&&!t.activeEvent.isCanceled?(c(),o("button",{key:5,onClick:n[1]||(n[1]=u(s=>t.cancelEvent(),["prevent"])),class:"btn btn-danger"},"Cancel Event")):y("",!0)]),e("div",null,[W,(c(!0),o(g,null,h(t.attendees,s=>(c(),o("img",{src:s.account.picture,alt:"Account pic",class:"rounded-circle attendPic",key:s.accountId,title:s.account.name},null,8,X))),128))])])])]),e("div",Z,[e("form",{onSubmit:n[3]||(n[3]=u(s=>t.createComment(),["prevent"]))},[t.account.id?(c(),o("div",$,[S(e("input",{type:"text",class:"form-control",placeholder:"Add a comment...","onUpdate:modelValue":n[2]||(n[2]=s=>t.editable.body=s)},null,512),[[I,t.editable.body]])])):y("",!0)],32),(c(!0),o(g,null,h(t.comments,s=>(c(),D(p,{key:s.id,comment:s},null,8,["comment"]))),128))])])])}var st=j(M,[["render",tt],["__scopeId","data-v-ae3c20b6"]]);export{st as default};
